## Values reference

- `domain` `(string: "dev.lamassu.io")` - The Domain in which Lamassu is to be deployed
- `debugMode` `(bool: true)` - Variable to indicate whether Lamassu services are deployed in debug mode.
- `storageClassName` 

- `tls`:
    - `type` `(string: "selfSigned")` - Type of certificate to be used by the API Gateway for external connections. Valid options are `selfSigned`, `letsEncrypt` and `external`.
    - `selfSignedOptions`:
        - `duration` `(string: "2160h")` - The duration of the generated self-signed certificates
    - `letsEncryptOptions`: - If the certificates generated by letsEncrypt will be of cluster issuer or issuer type. If it is of the issuer type, the secret can only be used in the namespace created, on the other hand, if it is of the issuer cluster type, the secret can be used in the whole cluster.
        - `clusterIssuer` `(bool: false)` 
        - `issuer` `(bool: true)`
    - `externalOptions`:
        - `secretName` `(string: "")` - Name of the secret created with the external certificates

- `postgres`:
    - `hostname` `(string: "")` - Address at which Postgres Database is located
    - `port` `(int: 5432)` - The port to be accessed to connect to the database
    - `username` `(string: "")` - Database user to perform authentication
    - `password` `(string: "")` - Password for authentication

- `ingress`:
    - `default` `(bool: false)`
    - `annotations`: |
        `kubernetes.io/ingress.class: "nginx"`

- `auth`:
    - `oidc`:
        - `frontend`:
            - `clientId` `(string: "frontend")` - The client ID configured in the authentication server
            - `authority` `(string: "https://dev.lamassu.io/auth/realms/lamassu")` - URL address of the authorization server
            - `awsCognito`
                - `enabled` `(bool: false)` - In case AWS Cognito is used as authentication server.
                - `hostedUiDomain` `(string: "")` - Domain where the server is hosted
        - `apiGateway`:
            - `jwksUrl` `(string: "https://auth:8443/auth/realms/lamassu/protocol/openid-connect/certs")` - It is a URL that points to a JSON Web Key Set (JWKS), which contains a collection of cryptographic keys used for verifying the authenticity of JSON Web Tokens (JWTs)
        - `authorization`
            - `rolesClaim` `(string: "realm_access.roles")`
            - `roles`: - Roles created in Lamassu
                - `admin` `(string: "admin")`
                - `operator` `(string: "operator")`

- `services`:
    - `keycloak`:
        - `enabled` `(bool: true)` - In case Keycloak is used as authentication server
        - `image` `(string: "ghcr.io/lamassuiot/keycloak:2.1.0")` - Docker image of the authentication service
        - `adminCreds`: - Credentials to access as administrator
            - `username` `(string: "admin")`
            - `password` `(string: "admin")`
        - `initUsers`: - Users to be created when the service is initialized
            - `username` `(string: "enroller")`
              `password` `(string: "enroller")`
              `roles`:
                - `pki-admin`
            - `username` `(string: "operator")`
              `password` `(string: "operator")`
    - `ui`:
        - `image` `(string: "ghcr.io/lamassuiot/lamassu-ui:2.2.0")` - Docker image of the ui service
    - `ocsp`:
        - `image` `(string: "ghcr.io/lamassuiot/lamassu-ocsp:2.2.0")` - Docker image of the ocsp service
    - `ca`:
        - `image` `(string: "ghcr.io/lamassuiot/lamassu-ca:2.2.0")` - Lamassu CA service docker image
        - `engine` `(string: "vault")` - The cryptographic engine used by the CA service
        - `aws`: - Variables to make the connection with AWS.
            - `region` `(string: "")`
            - `accessKeyId` `(string: "")`
            - `secretAccessKey` `(string: "")`
        - `aboutToExpire` `(int: 90)` 
        - `periodicScan`:
            - `enabled` `(bool: true)` - To activate the periodic scanning of the certificate status
            - `cron` `(string: "0 * * * *")` - Frequency of how often testing is to be performed
    - `deviceManager`:
        - `image` `(string: "ghcr.io/lamassuiot/lamassu-devmanager:2.2.0")` - Device Manager service docker image
        - `minimumReenrollmentDays` `(int: 100)` - The number of days before a certificate expires and admits the reenrollment of the certificate.
    - `dmsManager`:
        - `image` `(string: "ghcr.io/lamassuiot/lamassu-dmsmanager:2.2.0")` - DMS Manager service docker image
    - `openPolicyAgent`:
        - `image` `(string: "openpolicyagent/opa:0.37.1-envoy")` - Open Policy Agent service docker image
        - `remLogger`:
            - `image` `(string: "ghcr.io/lamassuiot/opa-rem-logger:2.1.0")` - REM Logger service docker image
    - `cloudProxy`:
        - `image` `(string: "ghcr.io/lamassuiot/lamassu-cloudproxy:2.2.0")` - Cloud Proxy service docker image
    - `alerts`:
        - `image` `(string: "ghcr.io/lamassuiot/lamassu-alerts:2.2.0")` - Alerts service docker image
        - `smtp`: - Variables to configure the SMTP mail server configuration
            - `from` `(string: "")`
            - `insecure` `(bool: false)`
            - `enable_ssl` `(bool: false)`
            - `username` `(string: "")`
            - `password` `(string: "")`
            - `host` `(string: "")`
            - `port` `(int: 25)` 
    - `awsConnector`:
        - `image` `(string: "ghcr.io/lamassuiot/lamassu-aws-connector:2.1.0")` - AWS Connector service docker image
        - `enabled` `(bool: false)` - To enable the AWS Connector service
        - `name` `(string: "")`
        - `aws`: - Variables to make the connection with AWS.
            - `accessKeyId` `(string: "")`
            - `secretAccessKey` `(string: "")`
            - `defaultRegion` `(string: "")`
            - `sqs`: - Name of the SQS queues used at Lamassu
                - `inboundQueueName` `(string: "")`
                - `outbountQueueName` `(string: "")`

- `simulationTools`:
    - `enabled` `(bool: false)` - To enable the simulation tools
    - `virtualDevice`:
        - `image` `(string: "lamassuiot/lamassuiot-virtual-device:2.0.0")` - Virtual Device simulation tool docker image
    - `virtualDms`:
        - `image` `(string: "lamassuiot/lamassuiot-virtual-dms:2.0.0")` - Virtual DMS simulation tool docker image

- `rabbitmq`:
    - `enabled` `(bool: true)` - To enable the deployment of the AMQP broker
    - `fullnameOverride` `(string: "rabbitmq")` - The name of the service
    - `global`:
        - `storageClass`
    - `podAnnotations`:
        - `reloader.stakater.com/auto`
    - `auth`:
        - `username` `(string: "user")` - Username to connect to the broker
        - `password` `(string: "user")` - Password to connect to the broker
        - `tls`:
            - `enabled` `(bool: true)` - To enable the connection to be made via HTTPS
            - `existingSecret` `(string: "rabbitmq-upstream-cert")`

- `consul`:
    - `fullnameOverride` `(string: "consul")` - The name of the service
    - `global`:
        - `enabled` `(bool: false)`
        - `datacenter` `(string: "lamassu-k8s")`
        - `tls`:
            - `enabled` `(bool: true)` - To enable the connection to be made via HTTPS
            - `enableAutoEncrypt` `(bool: true)`
            - `verify` `(bool: false)`
            - `caCert`:
                - `secretName` `(string: "ca-upstream-cert")`
    - `client`:
        - `enabled` `(bool: false)`
    - `server`:
        - `serverCert`:
            - `secretName` `(string: "consul-upstream-cert")`
        - `affinity` `(string: "null")`
        - `replicas` `(int: 3)` 
        - `storageClassName`
        - `extraConfig`: |
            {
                "enable_agent_tls_for_checks": true
            }

- `vault`:
    - `fullnameOverride` `(string: "")` - The name of the service
    - `global`:
        - `enabled` `(bool: true)`
        - `tlsDisable` `(bool: false)`
    - `server`:
        - `authDelegator`:
            - `enabled` `(bool: false)`
        - `affinity` `(string: "")`
        - `annotations`:
            - `reloader.stakater.com/auto` `(bool: true)`
        - `extraVolumes`:
            - `type`: `(string: "")`
              `name` `(string: "")`
        - `ha`:
            - `enabled` `(bool: true)`
            - `replicas`
            - `apiAddr` `(string: "")`
            - `config`: |
                ui = true
                listener "tcp" {
                address = "[::]:8200"
                cluster_address = "[::]:8201"
                tls_cert_file = "/vault/userconfig/vault-upstream-cert/tls.crt"
                tls_key_file  = "/vault/userconfig/vault-upstream-cert/tls.key"
                tls_client_ca_file = "/vault/userconfig/vault-upstream-cert/ca.crt"
                }

                storage "consul" {
                path = "vault/"
                address = "https://consul-server:8501"
                tls_ca_file = "/vault/userconfig/vault-upstream-cert/ca.crt"
                }

                service_registration "kubernetes" {}
    - `ui`:
        - `enabled` `(bool: false)`
    - `injector`:
        - `enabled` `(bool: false)`