openapi: 3.1.0
info:
  version: 2.0.0-oas3.1
  title: 'Lamassu IoT: DMS Service'
  description: >-
    The DMS Manager is the service in charge of managing the Registration
    Authority of the PKI. Instead of having a centralized Registration
    Authority, Lamassu uses a decentralized approach to be easily integrated by
    Device Manufacturing Systems. This way, each DMS has the authority to
    request the issuance of a certificate for a device being manufactured.
    Instead of relying on just one registration authority, Lamassu delegates the
    authorization of the issuance to the Local Registration Authority or LRA.


    Each DMS is entitled to authorize the issuance of a certificate to a subset
    of CAs of the entire PKI defined by the administrator. Each DMS has a list
    of authorized CAs that may be used during the enrollment process. Once an
    enrollment process is initiated, the PKI will check that the provided DMS
    certificate is authorized to issue certificates for the requested CA. The
    authorization list can be updated to add newly created CAs or remove CAs
    that are no longer needed.


    Some useful links:

    - [Lamassu IoT Github repository](https://github.com/lamassuiot/lamassuiot)

    - [Lamassu Iot
    Docs](https://www.lamassu.io/docs/2.0.0/architecture/#dms-manager)
security:
  - Oauth2: []
tags:
  - name: dms
  - name: stats
  - name: est
paths:
  /dms:
    get:
      tags:
        - dms
      summary: Get All DMS
      description: Get All DMS
      parameters: 
        - $ref: '#/components/parameters/sortByParam'
        - $ref: '#/components/parameters/sortModeParam'
        - $ref: '#/components/parameters/pageSizeParam'
        - $ref: '#/components/parameters/bookmarkParam'
        - $ref: '#/components/parameters/filterParam'
      responses:
        '200':
          description: Successful operation. Returns all DMS.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GetDMSResponse'
        '500':
          description: Something went wrong while getting all DMS.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/500Error'
    post:
      tags:
        - dms
      summary: Create DMS
      description: Create DMS
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/DMS'
      responses:
        '201':
          description: Successfull operation. Returns created DMS
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DMS'
        '500':
          description: Something went wrong while creating the DMS.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/500Error'
  /dms/{id}:
    get:
      tags:
        - dms
      summary: Get DMS by ID
      description: Get DMS by ID
      parameters:
        - $ref: '#/components/parameters/id'
          description: ID of the DMS to get.
      responses:
        '200':
          description: Successfull operation. Returns DMS
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DMS'
        '400':
          description: Struct validation error.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/400Error'
              example:
                err: Struct validation error
        '500':
          description: Something went wrong while getting the DMS.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/500Error'
    put:
      tags:
        - dms
      summary: Update DMS by ID
      description: Update DMS by ID
      parameters:
        - $ref: '#/components/parameters/id'
          description: ID of the DMS to update.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/DMS'
      responses:
        '200':
          description: Successfull operation. Returns DMS
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DMS'
        '400':
          description: Struct validation error.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/400Error'
              example:
                err: Struct validation error
        '500':
          description: Something went wrong while updating DMS.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/500Error'
  /dms/bind-identity:
    post:
      tags:
        - dms
      summary: Bind Identity to Device
      description: Bind Identity to Device
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/BindIdentityToDeviceBody'
      responses:
        '200':
          description: Successfull operation. Returns DMS
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BindIdentityToDeviceOutput'
        '400':
          description: Struct validation error.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/400Error'
              example:
                err: Struct validation error
        '500':
          description: Something went wrong while binding identity to device.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/500Error'
  /stats:
    get:
      tags:
        - stats
      summary: Get Stats
      description: Get Stats
      responses:
        '200':
          description: Successful operation. Returns the total of DMS.
          content:
            application/json:
              schema:
                type: object
                properties:
                  total:
                    type: integer
                    example: 6
                description: Total DMS
        '500':
          description: Something went wrong while getting stats.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/500Error'
  /.well-known/est/cacerts:
    get:
      tags:
        - est
      summary: Get CA Certificates
      description: Get CA Certificates
      security:
        - MTLS: []
      responses:
        '200':
          description: Successful operation. Returns CAs.
          content:
            application/x-pem-file:
              schema:
                type: string
                format: binary
            application/pkcs7-mime:
              schema:
                type: string
                format: binary
        '500':
          description: Something went wrong while getting certificates.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/500Error'
  /.well-known/est/{aps}/cacerts:
    get: 
      tags:
        - est
      summary: Get CA Certificates
      description: Get CA Certificates
      security:
        - MTLS: []
      parameters:
        - $ref: '#/components/parameters/aps'
      responses:
        '200':
          description: Successful operation. Returns CAs.
          content:
            application/x-pem-file:
              schema:
                type: string
                format: binary
            application/pkcs7-mime:
              schema:
                type: string
                format: binary
        '500':
          description: Something went wrong while getting certificates.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/500Error'
  /.well-known/est/simpleenroll:
    post:
      tags:
        - est
      summary: Simple Enroll for a Certificate
      description: Simple Enroll for a Certificate
      security:
        - MTLS: []
      requestBody:
        required: true
        content:
          application/pkcs10:
            schema:
              type: string
              format: binary
              description: The Certificate Signing Request (CSR) in PKCS#10 format.
      responses:
        '200':
          description: Successfully enrolled for a certificate.
          content:
            application/x-pem-file:
              schema:
                type: string
                format: binary
                description: The enrolled certificate in PEM format.
            application/pkcs7-mime:
              schema:
                type: string
                format: binary
                description: The enrolled certificate in PKCS#7 format.
        '400':
          description: >
            Bad Request. Possible error reasons: - Content-type must be
            application/pkcs10 - Could not read the body payload - Body payload
            must be base64 encoded - Could not parse the payload into a csr
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/400Error'
              example:
                err: Could not read the body payload
        '500':
          description: Something went wrong while ernolling.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/500Error'
  /.well-known/est/{aps}/simpleenroll:
    post:
      tags:
        - est
      summary: Simple Enroll for a Certificate Using an Identifier
      description: Simple Enroll for a Certificate Using an Identifier
      security:
        - MTLS: []
      parameters:
        - $ref: '#/components/parameters/aps'
      requestBody:
        required: true
        content:
          application/pkcs10:
            schema:
              type: string
              format: binary
              description: The Certificate Signing Request (CSR) in PKCS#10 format.
      responses:
        '200':
          description: Successfully enrolled for a certificate.
          content:
            application/x-pem-file:
              schema:
                type: string
                format: binary
                description: The enrolled certificate in PEM format.
            application/pkcs7-mime:
              schema:
                type: string
                format: binary
                description: The enrolled certificate in PKCS#7 format.
        '400':
          description: >
            Bad Request. Possible error reasons: - Content-type must be
            application/pkcs10 - Could not read the body payload - Body payload
            must be base64 encoded - Could not parse the payload into a csr
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/400Error'
              example:
                err: Could not read the body payload
        '500':
          description: Something went wrong while enrolling.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/500Error'
  /.well-known/est/simplerenroll:
    post:
      tags:
        - est
      summary: Simple Reenroll for a Certificate
      description: Simple Reenroll for a Certificate
      security:
        - MTLS: []
      requestBody:
        required: true
        content:
          application/pkcs10:
            schema:
              type: string
              format: binary
              description: The Certificate Signing Request (CSR) in PKCS#10 format.
      responses:
        '200':
          description: Successfully reenrolled for a certificate.
          content:
            application/x-pem-file:
              schema:
                type: string
                format: binary
                description: The reenrolled certificate in PEM format.
            application/pkcs7-mime:
              schema:
                type: string
                format: binary
                description: The reenrolled certificate in PKCS#7 format.
        '400':
          description: >
            Bad Request. Possible error reasons: - Content-type must be
            application/pkcs10 - Could not read the body payload - Body payload
            must be base64 encoded - Could not parse the payload into a csr
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/400Error'
              example:
                err: Could not read the body payload
        '500':
          description: Something went wrong while reenrolling.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/500Error'
  /.well-known/est/{aps}/simplerenroll:
    post:
      tags:
        - est
      summary: Simple Reenroll for a Certificate Using an Identifier
      description: Simple Reenroll for a Certificate Using an Identifier
      security:
        - MTLS: []
      parameters:
        - $ref: '#/components/parameters/aps'
      requestBody:
        required: true
        content:
          application/pkcs10:
            schema:
              type: string
              format: binary
              description: The Certificate Signing Request (CSR) in PKCS#10 format.
      responses:
        '200':
          description: Successfully reenrolled for a certificate.
          content:
            application/x-pem-file:
              schema:
                type: string
                format: binary
                description: The reenrolled certificate in PEM format.
            application/pkcs7-mime:
              schema:
                type: string
                format: binary
                description: The reenrolled certificate in PKCS#7 format.
        '400':
          description: >
            Bad Request. Possible error reasons: - Content-type must be
            application/pkcs10 - Could not read the body payload - Body payload
            must be base64 encoded - Could not parse the payload into a csr
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/400Error'
              example:
                err: Could not read the body payload
        '500':
          description: Something went wrong while reenrolling.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/500Error'
components:
  parameters:
    sortByParam:
      name: sort_by
      in: query
      description: Field by which to sort the results.
      required: false
      schema:
        type: string
        example: name
    sortModeParam:
      name: sort_mode
      in: query
      description: Sort mode, can be 'asc' for ascending or 'desc' for descending.
      required: false
      schema:
        type: string
        enum: [asc, desc]
        example: asc
    pageSizeParam:
      name: page_size
      in: query
      description: Number of items per page.
      required: false
      schema:
        type: integer
        example: 5
    bookmarkParam:
      name: bookmark
      in: query
      description: Bookmark for pagination.
      required: false
      schema:
        type: string
        example: "bm12345"
    filterParam:
      name: filter
      in: query
      description: |
        Filter criteria. Example format: field[operation]=value.
        Supported operations for string fields: eq (equal), ne (not equal), ct (contains), nc (not contains).
        Supported operations for date fields: bf (before), eq (equal), af (after).
        Supported operations for number fields: eq (equal), ne (not equal), lt (less than), le (less or equal), gt (greater than), ge (greater or equal).
      required: false
      schema:
        type: string
        example: status[eq]=active
    id:
      in: path
      name: id
      required: true
      schema:
        type: string
    aps:
      in: path
      name: aps
      required: true
      schema:
        type: string
      description: The identifier of the Authorization Point System (APS).
  schemas:
    GetDMSResponse:
      type: object
      properties:
        next:
          type: string
        list:
          type: array
          items:
            $ref: '#/components/schemas/DMS'
    DMS:
      type: object
      properties:
        id:
          type: string
        name:
          type: string
        metadata:
          type: object
          additionalProperties: true
          example: 
            "lamassu.io/iot/aws.954121426360":
              groups:
                - "TEST-LMS"
              jitp_config:
                aws_ca_id: ""
                enable_template: false
                provisioning_role_arn: ""
              policies:
                policy_document: "{\"Version\":\"2012-10-17\",\"Statement\":[{\"Effect\":\"Allow\",\"Action\":[\"iot:*\"],\"Resource\":[\"*\"]}]}"
                policy_name: "my-p"
              registration_mode: "auto"
              shadow_config:
                enable: true
        creation_ts:
          type: string
          format: date-time
        settings:
          $ref: '#/components/schemas/DMSSettings'
      required:
        - id
        - name
    DMSSettings:
      type: object
      properties:
        enrollment_settings:
          $ref: '#/components/schemas/EnrollmentSettings'
        reenrollment_settings:
          $ref: '#/components/schemas/ReEnrollmentSettings'
        ca_distribution_settings:
          $ref: '#/components/schemas/CADistributionSettings'
    EnrollmentSettings:
      type: object
      properties:
        protocol:
          type: string
          enum:
            - EST_RFC7030
        est_rfc7030_settings:
          $ref: '#/components/schemas/EnrollmentOptionsESTRFC7030'
        device_provisioning_profile:
          $ref: '#/components/schemas/DeviceProvisionProfile'
        enrollment_ca:
          type: string
        enable_replaceable_enrollment:
          type: boolean
        registration_mode:
          type: string
          enum:
            - JITP
            - PRE_REGISTRATION
    ReEnrollmentSettings:
      type: object
      properties:
        additional_validation_cas:
          type: array
          items:
            type: string
        reenrollment_delta:
          type: integer
          format: int64
          description: time.Duration type
        enable_expired_renewal:
          type: boolean
        preventive_delta:
          type: integer
          format: int64
          description: time.Duration type
        critical_delta:
          type: integer
          format: int64
          description: time.Duration type
    CADistributionSettings:
      type: object
      properties:
        include_system_ca:
          type: boolean
        include_enrollment_ca:
          type: boolean
        managed_cas:
          type: array
          items:
            type: string
    EnrollmentOptionsESTRFC7030:
      type: object
      properties:
        auth_mode:
          type: string
          enum:
            - ESTServerKeyGenBitSize
            - ESTServerKeyGenKeyType
        client_certificate_settings:
          $ref: '#/components/schemas/AuthOptionsClientCertificate'
    AuthOptionsClientCertificate:
      type: object
      properties:
        validation_cas:
          type: array
          items:
            type: string
        chain_level_validation:
          type: integer
    DeviceProvisionProfile:
      type: object
      properties:
        icon:
          type: string
        icon_color:
          type: string
        metadata:
          type: object
          additionalProperties: true
        tags:
          type: array
          items:
            type: string
    BindIdentityToDeviceBody:
      type: object
      properties:
        bind_mode:
          type: string
          enum:
            - CREATED
            - PROVISIONED
            - RE-PROVISIONED
            - RENEWED
            - SHADOW-UPDATED
            - STATUS-UPDATED
            - DECOMMISSIONED
        device_id:
          type: string
        certificate_serial_number:
          type: string
      required:
        - bind_mode
        - device_id
        - certificate_serial_number
    BindIdentityToDeviceOutput:
      type: object
      properties:
        certificate:
          type: string
          example: "LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUdyVENDQkpXZ0F3SUJBZ0lRRGlHdHRrcnAvUDZSd2h3L044bDZCakFOQmdrcWhraUc5dzBCQVFzRkFEQncKTVJFd0R3WURWUVFHREFnOGMzUnlhVzVuUGpFUk1BOEdBMVVFQ0F3SVBITjBjbWx1Wno0eEVUQVBCZ05WQkFjTQpDRHh6ZEhKcGJtYytNUkV3RHdZRFZRUUtEQWc4YzNSeWFXNW5QakVSTUE4R0ExVUVDd3dJUEhOMGNtbHVaejR4CkR6QU5CZ05WQkFNVEJuQnlkV1ZpWVRBZUZ3MHlOREEyTVRjd056QTBOREZhRncweU5UQTBNVE13TnpBME16bGEKTUhBeEVUQVBCZ05WQkFZTUNEeHpkSEpwYm1jK01SRXdEd1lEVlFRSURBZzhjM1J5YVc1blBqRVJNQThHQTFVRQpCd3dJUEhOMGNtbHVaejR4RVRBUEJnTlZCQW9NQ0R4emRISnBibWMrTVJFd0R3WURWUVFMREFnOGMzUnlhVzVuClBqRVBNQTBHQTFVRUF4TUdjSEoxWldKaE1JSUNJakFOQmdrcWhraUc5dzBCQVFFRkFBT0NBZzhBTUlJQ0NnS0MKQWdFQTN1ZVZOMDljVE4vUUljRnBTV3hkN3JxNGFKSmRva0xqb2dGNklsUmkzbGNrUEhiYWZxZG04Z2c4YVpVaQo3SDhyRVJuRHdVWVViSUgzTzNSSlZ3MHhzdjV4YVZzM2M1VGdYb2JtNG90cDZhT2JST25RcmEwVWpISk8zRytECkJQRnVRci96OHlQSGxhVkpJNklWM3JlWW5sNEFkY09yZkJoRzVDaDJuTDdUcmdiNnJHdVhiMmRyYmlhRHE3ZDAKcW9UK1Y4MWlyQ2JHUnZEU1g2bWZNRm1INDNKYW9ZdnYveDh0SUk1dzVmNXFHU3k4S2U2ekRnOFoyZktSWUtJNwpTQmpFc0hRUGIxZXZidnhvRWRiRHgwOW5VSHBxSHR2bnNwMmdDWEdydGxsb1pMV0RYMGZ1Nmo2a1E2aWpnWXEvCnA2Q1FMTG4xYmdoREVlVDlmOGp4YVhlWHNlRWFaTS9laVpROHVPbVV1dzBTZVZ0UWhvWllmanZyNlNLRjhxUkYKbkRxbnlqMXo5RlZnTkdiall5NlpmMTVoMmw4bE1tQ0s4WUN5V1BmMk4rMWlXcHBnejh0QUxWOCtWb3VhZXNPSwp6MytDZGVUWWxWdzQ0QmNuc0dKN1dFZjluMEdteGs4VHp3OXNUQmYyZWVQaXp3K2NScSt6ekV4NHJ1dUlRc3JoCnRtVTQxMm83TUplaXh0RnN2N3pGUEN0L0lNMGg2Umx0ZGlwREJvOE4wYVl2N1pzVzdVM2hDajJXaWEzclg5TDMKM0JwTVQ2RDlwbGZFZXF2V0ZMQjBEcWFPS0s0dndyVmNYcnB1bm0wZnlic0NwaURCRGJvaUxYeE1CdDYxb2p3QQpvSklKNDVJTnIrWkd2cG5IS0s0SncydnpMVkl3MU5DYzhBa01RcDRmTm9ZZlhVRUNBd0VBQWFPQ0FVRXdnZ0U5Ck1BNEdBMVVkRHdFQi93UUVBd0lCbGpBZEJnTlZIU1VFRmpBVUJnZ3JCZ0VGQlFjREFnWUlLd1lCQlFVSEF3RXcKRHdZRFZSMFRBUUgvQkFVd0F3RUIvekF0QmdOVkhRNEVKZ1FrWVRkaU1EZzFOMll0TW1KaU5TMDBNREV6TFRneQpabVF0TURoaU9EUmlabUk0WTJGaE1DOEdBMVVkSXdRb01DYUFKR0UzWWpBNE5UZG1MVEppWWpVdE5EQXhNeTA0Ck1tWmtMVEE0WWpnMFltWmlPR05oWVRCQUJnZ3JCZ0VGQlFjQkFRUTBNREl3TUFZSUt3WUJCUVVITUFHR0pHaDAKZEhCek9pOHZaR1YyTG14aGJXRnpjM1V1ZEdWemRDOWhjR2t2ZG1FdmIyTnpjREJaQmdOVkhSOEVVakJRTUU2ZwpUS0JLaGtob2RIUndjem92TDJSbGRpNXNZVzFoYzNOMUxuUmxjM1F2WVhCcEwzWmhMMk55YkM5aE4ySXdPRFUzClppMHlZbUkxTFRRd01UTXRPREptWkMwd09HSTROR0ptWWpoallXRXdEUVlKS29aSWh2Y05BUUVMQlFBRGdnSUIKQUpwcUxOMWNXcDlKclJZL21Vcmx0dEFERlJ3a2o5YmlkbDJITVVDeVJCaDA0bFhVWnREaDdaUkFYRUlZY3R4bgppeU56eDY5MXZIVGtBMUt0YW05TUc3TzNCS3I4bk1QZjM3VE1ZTDJtOENRZFU2STZqRUFrUktBZVZqL0p5TGVSClVDSmpzcVdOYVpuYmV0a3FHRk5qbktiU0NOSm1uQ2VMeUVHSk1ScncvWTQyZlp0NE5DYXltM1ZlODRlekl2MGUKOFpmbFVhWEgrckNpYVZ5cHY5S3BudUpCZWRsOVdDUlJ3TTR0ZGs5bmJNbmcreGZLMnZuMkRWNmhKellKME1jWApmYUlnRDU1MFdwQmt0N0JBbWhNd0VWQkNKWWhQNmw3cjhjaVRtdTdRMWJhZ1VwY0tWY002cTNaVitHdUNyaStpCmhqOFQzY1Job2RNUmdrZHpFZ2dzSkRhL2NwWVVwOFpTU0RQTWk5V3FVaWY4Mm56dFJiakRmc3MwRnV4T04yWTYKZlFMTWpZZFhXVW0xTzk5Qkw5TnJtYkVldG5sY08zTDRlYk9NdXRGUDV1YlV1MXZNUjF6VURnM2x6VFA2Wk1BcApyV0hxUi9IU1NxVlRuTnMrUnNsb2UvV0g5cUhFVGlFMFNBaEx0d3EvUzZDRzZKVm91TWd3VVFHdEJLQllDSGxKCkZ5OU1zdXdJL2t3NXZGTGJRTXpSc01tT3dFeFN4VHhMU1lkczBqZm84OU1VZGFCQWdrTEJTc2VpQ0I4cFBoMCsKMEFrRW5GbEVoYjJpTktLZ1F6cGN4NTBleHN3aktyVXdWck9BUTFQRnpXYlFOVWdtc2dCVmpmZDZ3N2hMQ3FyLwo5M3NTUzduSXh6V1lSRjVnYW8vb21QVlYxeUVRaWk4TFoybk5zbHMweXA3eQotLS0tLUVORCBDRVJUSUZJQ0FURS0tLS0tCg="
        dms:
          $ref: '#/components/schemas/DMS'
        device:
          $ref: '#/components/schemas/Device'
    Device:
      type: object
      properties:
        id:
          type: string
        tags:
          type: array
          items:
            type: string
        status:
          $ref: '#/components/schemas/DeviceStatus'
        icon:
          type: string
        icon_color:
          type: string
        creation_timestamp:
          type: string
          format: date-time
        metadata:
          type: object
          additionalProperties: true
        dms_owner:
          type: string
        identity:
          $ref: '#/components/schemas/Slot'
        slots:
          type: object
          additionalProperties:
            $ref: '#/components/schemas/Slot'
        events:
          type: object
          additionalProperties:
            $ref: '#/components/schemas/DeviceEvent'
    DeviceStatus:
      type: string
      enum:
        - NO_IDENTITY
        - ACTIVE
        - RENEWAL_PENDING
        - EXPIRING_SOON
        - EXPIRED
        - REVOKED
        - DECOMMISSIONED
    Slot:
      type: object
      properties:
        status:
          type: string
          enum:
            - ACTIVE
            - RENEWAL_PENDING
            - EXPIRING_SOON
            - EXPIRED
            - REVOKED
        active_version:
          type: integer
        type:
          type: string
          enum:
            - TOKEN
            - x509
            - SSH_KEY
            - OTHER
        versions:
          type: object
          additionalProperties: true
        events:
          type: object
          additionalProperties:
            $ref: '#/components/schemas/DeviceEvent'
    DeviceEvent:
      type: object
      properties:
        type:
          type: string
          enum:
            - CREATED
            - PROVISIONED
            - RE-PROVISIONED
            - RENEWED
            - SHADOW-UPDATED
            - STATUS-UPDATED
            - DECOMMISSIONED
        description:
          type: string
    pkixName:
      type: object
      properties:
        country:
          type: array
          items:
            type: string
        organization:
          type: array
          items:
            type: string
        organizational_unit:
          type: array
          items:
            type: string
        locality:
          type: array
          items:
            type: string
        province:
          type: array
          items:
            type: string
        street_address:
          type: array
          items:
            type: string
        postal_code:
          type: array
          items:
            type: string
        serial_number:
          type: string
        common_name:
          type: string
        names:
          type: array
          items:
            $ref: '#/components/schemas/pkixAttributeTypeAndValue'
          description: All parsed attributes
        extra_names:
          type: array
          items:
            $ref: '#/components/schemas/pkixAttributeTypeAndValue'
          description: Attributes to be copied raw into any marshaled distinguished names
    pkixAttributeTypeAndValue:
      type: object
      properties:
        type:
          type: array
          items:
            type: integer
        value:
          type: object
    pkixAttributeTypeAndValueSET:
      type: object
      properties:
        type:
          type: array
          items:
            type: integer
          description: ASN.1 Object Identifier
        value:
          type: array
          items:
            type: array
            items:
              $ref: '#/components/schemas/pkixAttributeTypeAndValue'
          description: A set of sets of AttributeTypeAndValue
    pkixExtension:
      type: object
      properties:
        ID:
          type: array
          items:
            type: integer
        critical:
          type: boolean
        value:
          type: string
          format: byte
    URL:
      type: object
      properties:
        scheme:
          type: string
        opaque:
          type: string
          description: Encoded opaque data
        user:
          $ref: '#/components/schemas/UserInfo'
        host:
          type: string
          description: Host or host:port
        path:
          type: string
          description: Path (relative paths may omit leading slash)
        raw_path:
          type: string
          description: Encoded path hint
        omit_host:
          type: boolean
          description: Do not emit empty host (authority)
        force_query:
          type: boolean
          description: Append a query ('?') even if RawQuery is empty
        raw_query:
          type: string
          description: Encoded query values, without '?'
        fragment:
          type: string
          description: Fragment for references, without '#'
        raw_fragment:
          type: string
          description: Encoded fragment hint
    UserInfo:
      type: object
      properties:
        username:
          type: string
        password:
          type: string
        password_set:
          type: boolean
    BigInt:
      type: object
      properties:
        neg:
          type: boolean
        abs:
            type: integer
    IPNet:
      type: object
      properties:
        IP:
          type: string
          format: ipv4
        IPMask:
          type: string
          format: ipv4
    OID:
      type: object
      properties:
        der:
          type: string
          format: byte
    400Error:
      type: object
      properties:
        err: 
          type: string
          enum:
            - Struct validation error
            - Content-type must be application/pkcs10 
            - Could not read the body payload 
            - Body payload must be base64 encoded 
            - Could not parse the payload into a csr
    500Error:
      type: object
      properties:
        err: 
          type: string
          enum:
            - Internal Server Error
          example: Internal Server Error
  securitySchemes:
    Oauth2:
      type: oauth2
      flows:
        authorizationCode:
          authorizationUrl: https://localhost/auth/realms/lamassu/protocol/openid-connect/auth
          tokenUrl: https://localhost/auth/realms/lamassu/protocol/openid-connect/token
          scopes: {}
        clientCredentials:
          tokenUrl: https://localhost/auth/realms/lamassu/protocol/openid-connect/token
          scopes: {}
    NoAuth:
      type: http
      scheme: bearer
          
          
servers:
  - description: Local
    url: https://localhost:8443/api/dmsmanager/v1
  - description: est
    url: https://localhost:8443/api/dmsmanager